<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Emacsbridge: EmacsServer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Emacsbridge
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-slots">Public Slots</a> &#124;
<a href="#signals">Signals</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classEmacsServer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">EmacsServer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="emacsserver_8h_source.html">emacsserver.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for EmacsServer:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classEmacsServer.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-slots"></a>
Public Slots</h2></td></tr>
<tr class="memitem:aad292c65d5dba28d68f3859e8957a71a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#aad292c65d5dba28d68f3859e8957a71a">startServer</a> ()</td></tr>
<tr class="separator:aad292c65d5dba28d68f3859e8957a71a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50e722ccfd406721163115ac76a81ca4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#a50e722ccfd406721163115ac76a81ca4">restartServer</a> ()</td></tr>
<tr class="separator:a50e722ccfd406721163115ac76a81ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a098e452eb92dff0d713643e8d9eadcb9"><td class="memItemLeft" align="right" valign="top">quint16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#a098e452eb92dff0d713643e8d9eadcb9">activeServerPort</a> ()</td></tr>
<tr class="separator:a098e452eb92dff0d713643e8d9eadcb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a114290124c50580493b66cc653b5bbde"><td class="memItemLeft" align="right" valign="top">QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#a114290124c50580493b66cc653b5bbde">callIntent</a> (const QString &amp;jsonString)</td></tr>
<tr class="separator:a114290124c50580493b66cc653b5bbde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24c1f7a59c0784abb3058f8ff08048a9"><td class="memItemLeft" align="right" valign="top">QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#a24c1f7a59c0784abb3058f8ff08048a9">checkPermissions</a> (const QString &amp;intentClass)</td></tr>
<tr class="separator:a24c1f7a59c0784abb3058f8ff08048a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="signals"></a>
Signals</h2></td></tr>
<tr class="memitem:ae24fcebc0859ee8950e988554610e730"><td class="memItemLeft" align="right" valign="top"><a id="ae24fcebc0859ee8950e988554610e730"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>componentAdded</b> (const <a class="el" href="structQmlFileContainer.html">QmlFileContainer</a> &amp;qmlFile)</td></tr>
<tr class="separator:ae24fcebc0859ee8950e988554610e730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a46d6fa39d7d6fafba6895095e4d86d"><td class="memItemLeft" align="right" valign="top"><a id="a7a46d6fa39d7d6fafba6895095e4d86d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>componentRemoved</b> (const QString &amp;qmlFile)</td></tr>
<tr class="separator:a7a46d6fa39d7d6fafba6895095e4d86d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af180efd48dd38f462c2c8765a9020636"><td class="memItemLeft" align="right" valign="top"><a id="af180efd48dd38f462c2c8765a9020636"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>dataSet</b> (const <a class="el" href="structJsonDataContainer.html">JsonDataContainer</a> &amp;jsonData)</td></tr>
<tr class="separator:af180efd48dd38f462c2c8765a9020636"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16cf04e88f7a955e806426fb2694ab96"><td class="memItemLeft" align="right" valign="top"><a id="a16cf04e88f7a955e806426fb2694ab96"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>notificationAdded</b> (const QString &amp;title, const QString &amp;message)</td></tr>
<tr class="separator:a16cf04e88f7a955e806426fb2694ab96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae775e21a8fce68fd9cc0b93daad63a3f"><td class="memItemLeft" align="right" valign="top"><a id="ae775e21a8fce68fd9cc0b93daad63a3f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>activePortChanged</b> (const quint16 port)</td></tr>
<tr class="separator:ae775e21a8fce68fd9cc0b93daad63a3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3be8522e56dc966bc474668a4acbbd8"><td class="memItemLeft" align="right" valign="top"><a id="ab3be8522e56dc966bc474668a4acbbd8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>androidPermissionDenied</b> (const QString &amp;permission)</td></tr>
<tr class="separator:ab3be8522e56dc966bc474668a4acbbd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e3335b2cc6ad03f55de50b1caea3cab"><td class="memItemLeft" align="right" valign="top"><a id="a7e3335b2cc6ad03f55de50b1caea3cab"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>parseMorse</b> (int level)</td></tr>
<tr class="separator:a7e3335b2cc6ad03f55de50b1caea3cab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ada18dbe6e2d80ea9ca508fb7c0c36b6f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#ada18dbe6e2d80ea9ca508fb7c0c36b6f">validAuthToken</a> (const QString &amp;token)</td></tr>
<tr class="separator:ada18dbe6e2d80ea9ca508fb7c0c36b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a496f57b0b4ad930622b7770215335c74"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#a496f57b0b4ad930622b7770215335c74">startHttpServer</a> ()</td></tr>
<tr class="separator:a496f57b0b4ad930622b7770215335c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43de9f904b2b8f8be59252fde1af20ca"><td class="memItemLeft" align="right" valign="top">QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#a43de9f904b2b8f8be59252fde1af20ca">listDirectory</a> (const QString &amp;directory)</td></tr>
<tr class="separator:a43de9f904b2b8f8be59252fde1af20ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a136119742da0ab7287740db85fb82fa4"><td class="memItemLeft" align="right" valign="top">QHttpServerResponse&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#a136119742da0ab7287740db85fb82fa4">methodCall</a> (const QString &amp;method, const QByteArray &amp;payload)</td></tr>
<tr class="separator:a136119742da0ab7287740db85fb82fa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16d5d4f4f10c9b8bc9f6276ad6b15d75"><td class="memItemLeft" align="right" valign="top">QHttpServerResponse&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#a16d5d4f4f10c9b8bc9f6276ad6b15d75">settingCall</a> (const QString &amp;setting, const QByteArray &amp;payload)</td></tr>
<tr class="separator:a16d5d4f4f10c9b8bc9f6276ad6b15d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad13c46e6369996e64d2e51d7b128b1df"><td class="memItemLeft" align="right" valign="top">QHttpServerResponse&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#ad13c46e6369996e64d2e51d7b128b1df">addComponent</a> (const QJsonObject &amp;jsonObject)</td></tr>
<tr class="separator:ad13c46e6369996e64d2e51d7b128b1df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73c7d5f66cae91486fd0ab5146833a51"><td class="memItemLeft" align="right" valign="top">QHttpServerResponse&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#a73c7d5f66cae91486fd0ab5146833a51">addNotification</a> (const QJsonObject &amp;jsonObject)</td></tr>
<tr class="separator:a73c7d5f66cae91486fd0ab5146833a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c44753b6c67b48ff08fbedc92fe0c67"><td class="memItemLeft" align="right" valign="top">QHttpServerResponse&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#a8c44753b6c67b48ff08fbedc92fe0c67">handleIntent</a> (const QJsonObject &amp;jsonObject, const QString &amp;jsonString)</td></tr>
<tr class="separator:a8c44753b6c67b48ff08fbedc92fe0c67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1509713c1dce19643ad4c10d8c5c2b6"><td class="memItemLeft" align="right" valign="top">QHttpServerResponse&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#ac1509713c1dce19643ad4c10d8c5c2b6">handleSensorCall</a> (const QJsonObject &amp;jsonObject)</td></tr>
<tr class="separator:ac1509713c1dce19643ad4c10d8c5c2b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba32ce7ceec3aa0beef9530db8459d35"><td class="memItemLeft" align="right" valign="top">QHttpServerResponse&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#aba32ce7ceec3aa0beef9530db8459d35">parseFile</a> (const QString &amp;fileName)</td></tr>
<tr class="separator:aba32ce7ceec3aa0beef9530db8459d35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaec7b23b312a475a45c2832c44e437d2"><td class="memItemLeft" align="right" valign="top">QHttpServerResponse&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#aaec7b23b312a475a45c2832c44e437d2">removeComponent</a> (const QJsonObject &amp;jsonObject)</td></tr>
<tr class="separator:aaec7b23b312a475a45c2832c44e437d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fc08811ca1c3827ff560cd353b97f2a"><td class="memItemLeft" align="right" valign="top">QHttpServerResponse&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmacsServer.html#a9fc08811ca1c3827ff560cd353b97f2a">setData</a> (const QJsonObject &amp;jsonObject, const QString &amp;jsonString)</td></tr>
<tr class="separator:a9fc08811ca1c3827ff560cd353b97f2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a1f7643741777ff443c97e0ec8215c287"><td class="memItemLeft" align="right" valign="top"><a id="a1f7643741777ff443c97e0ec8215c287"></a>
QHttpServer *&#160;</td><td class="memItemRight" valign="bottom"><b>m_server</b></td></tr>
<tr class="separator:a1f7643741777ff443c97e0ec8215c287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab663666b7f210f79038622eb82961325"><td class="memItemLeft" align="right" valign="top"><a id="ab663666b7f210f79038622eb82961325"></a>
QDateTime&#160;</td><td class="memItemRight" valign="bottom"><b>m_startupTime</b></td></tr>
<tr class="separator:ab663666b7f210f79038622eb82961325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb76dcd6c826ae5f1e1791065b68449b"><td class="memItemLeft" align="right" valign="top"><a id="abb76dcd6c826ae5f1e1791065b68449b"></a>
QString&#160;</td><td class="memItemRight" valign="bottom"><b>m_htmlTemplate</b></td></tr>
<tr class="separator:abb76dcd6c826ae5f1e1791065b68449b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95f9b314c9946189ee826f68ce02cfd2"><td class="memItemLeft" align="right" valign="top"><a id="a95f9b314c9946189ee826f68ce02cfd2"></a>
QString&#160;</td><td class="memItemRight" valign="bottom"><b>m_dataPath</b></td></tr>
<tr class="separator:a95f9b314c9946189ee826f68ce02cfd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e0226e0fb891de0253930ac90f0136"><td class="memItemLeft" align="right" valign="top"><a id="ac8e0226e0fb891de0253930ac90f0136"></a>
<a class="el" href="classEmacsBridgeMorse.html">EmacsBridgeMorse</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>m_morseInterpreter</b></td></tr>
<tr class="separator:ac8e0226e0fb891de0253930ac90f0136"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4101bb529a46957252e47356268aa7e"><td class="memItemLeft" align="right" valign="top"><a id="ae4101bb529a46957252e47356268aa7e"></a>
QAmbientLightSensor *&#160;</td><td class="memItemRight" valign="bottom"><b>m_ambientLightSensor</b></td></tr>
<tr class="separator:ae4101bb529a46957252e47356268aa7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class provides the HTTP server to serve documentation pages, allow initial configuration from Emacs side, and provide the RPC endpoints used from Emacs. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a098e452eb92dff0d713643e8d9eadcb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a098e452eb92dff0d713643e8d9eadcb9">&#9670;&nbsp;</a></span>activeServerPort</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">quint16 EmacsServer::activeServerPort </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the current server listen port, or 0</dd></dl>
<p>The server is supposed to listen to only one port. If something went went wrong and the server listens to more than one the first listen port is returned. In this case, and if the server is not listening at all a critical log message is logged. </p>

</div>
</div>
<a id="ad13c46e6369996e64d2e51d7b128b1df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad13c46e6369996e64d2e51d7b128b1df">&#9670;&nbsp;</a></span>addComponent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QHttpServerResponse EmacsServer::addComponent </td>
          <td>(</td>
          <td class="paramtype">const QJsonObject &amp;&#160;</td>
          <td class="paramname"><em>jsonObject</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Verify the data, and add a new QML component to the application if the provided data is valid. Note that overwriting an existing component typically requires a restart of the applications due to shortcomings in the QML garbage collector.</p>
<dl class="section return"><dt>Returns</dt><dd>QHttpServerResponder::StatusCode::BadRequest on error. Both the error and success messages are designed to be exposed to the Emacs UI and are translatable. </dd></dl>

</div>
</div>
<a id="a73c7d5f66cae91486fd0ab5146833a51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73c7d5f66cae91486fd0ab5146833a51">&#9670;&nbsp;</a></span>addNotification()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QHttpServerResponse EmacsServer::addNotification </td>
          <td>(</td>
          <td class="paramtype">const QJsonObject &amp;&#160;</td>
          <td class="paramname"><em>jsonObject</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Display the provided notification via platform specific UI.</p>
<dl class="section return"><dt>Returns</dt><dd>OK. Most notification backends don't provide much error error handling, so the assumption is always that the call succeeded. </dd></dl>

</div>
</div>
<a id="a114290124c50580493b66cc653b5bbde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114290124c50580493b66cc653b5bbde">&#9670;&nbsp;</a></span>callIntent</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QString EmacsServer::callIntent </td>
          <td>(</td>
          <td class="paramtype">const QString &amp;&#160;</td>
          <td class="paramname"><em>jsonString</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Call a JSON encoded Android intent through callIntentFromJson() on Java side in EmacsBridgeService.</p>
<dl class="section return"><dt>Returns</dt><dd>OK on success, Java exception string on error </dd></dl>

</div>
</div>
<a id="a24c1f7a59c0784abb3058f8ff08048a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24c1f7a59c0784abb3058f8ff08048a9">&#9670;&nbsp;</a></span>checkPermissions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QString EmacsServer::checkPermissions </td>
          <td>(</td>
          <td class="paramtype">const QString &amp;&#160;</td>
          <td class="paramname"><em>intentClass</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Look up the permissions required for <em>intentClass</em>, check if those are granted, and request the permission dialog from the UI if they are not.</p>
<p>An Android service is not allowed to request permissions, so all we can do here is check if permissions have been granted already. If the result is "denied" the UI is triggered to request permission - but to avoid blocking this function returns without waiting for the result.</p>
<p>The permission may not be granted, or be granted at a later time (and possibly revoked again), so code should handle missing permissions gracefully. If a permission was denied code should continue without those permissions, if possible. If it is not possible a short wait and several retries are an option before aborting.</p>
<p>The following classes are currently supported:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Class </th><th class="markdownTableHeadNone">Permission  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">com.termux.app.RunCommandService </td><td class="markdownTableBodyNone">com.termux.permission.RUN_COMMAND  </td></tr>
</table>
<p>Note: Currently the implementation can only request a single permission per class name.</p>
<dl class="section return"><dt>Returns</dt><dd>"" on success, or the denied permission name </dd></dl>

</div>
</div>
<a id="a8c44753b6c67b48ff08fbedc92fe0c67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c44753b6c67b48ff08fbedc92fe0c67">&#9670;&nbsp;</a></span>handleIntent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QHttpServerResponse EmacsServer::handleIntent </td>
          <td>(</td>
          <td class="paramtype">const QJsonObject &amp;&#160;</td>
          <td class="paramname"><em>jsonObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QString &amp;&#160;</td>
          <td class="paramname"><em>jsonString</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Do a validity check on the provided data before executing the intent through <a class="el" href="classEmacsServer.html#a114290124c50580493b66cc653b5bbde">callIntent()</a></p>
<dl class="section return"><dt>Returns</dt><dd>QHttpServerResponder::StatusCode::BadRequest on error. Both the error and success messages are designed to be exposed to the Emacs UI and are translatable. </dd></dl>

</div>
</div>
<a id="ac1509713c1dce19643ad4c10d8c5c2b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1509713c1dce19643ad4c10d8c5c2b6">&#9670;&nbsp;</a></span>handleSensorCall()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QHttpServerResponse EmacsServer::handleSensorCall </td>
          <td>(</td>
          <td class="paramtype">const QJsonObject &amp;&#160;</td>
          <td class="paramname"><em>jsonObject</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Dummy method supposed to handle sensor control in the future </p>

</div>
</div>
<a id="a43de9f904b2b8f8be59252fde1af20ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43de9f904b2b8f8be59252fde1af20ca">&#9670;&nbsp;</a></span>listDirectory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QString EmacsServer::listDirectory </td>
          <td>(</td>
          <td class="paramtype">const QString &amp;&#160;</td>
          <td class="paramname"><em>directory</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>List the directory given in <em>directory</em>.</p>
<dl class="section return"><dt>Returns</dt><dd>a string containing a HTML page with the directory listing </dd></dl>

</div>
</div>
<a id="a136119742da0ab7287740db85fb82fa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a136119742da0ab7287740db85fb82fa4">&#9670;&nbsp;</a></span>methodCall()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QHttpServerResponse EmacsServer::methodCall </td>
          <td>(</td>
          <td class="paramtype">const QString &amp;&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QByteArray &amp;&#160;</td>
          <td class="paramname"><em>payload</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check which RPC method to call, verify data, and call the method if everything is correct.</p>
<p>This got split out from the /rpc mapping of <a class="el" href="classEmacsServer.html#a496f57b0b4ad930622b7770215335c74">startHttpServer()</a> to simplify the code.</p>
<p>This function does some basic validation of the provided JSON data, and calls the endpoint specific method with verified data. It then returns the return value of that method call.</p>
<dl class="section return"><dt>Returns</dt><dd>QHttpServerResponder::StatusCode::BadRequest on error or the return value of the endpoint method call </dd></dl>

</div>
</div>
<a id="aba32ce7ceec3aa0beef9530db8459d35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba32ce7ceec3aa0beef9530db8459d35">&#9670;&nbsp;</a></span>parseFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QHttpServerResponse EmacsServer::parseFile </td>
          <td>(</td>
          <td class="paramtype">const QString &amp;&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Open a file (from filesystem or resource) and replace all valid keys in template notation ({{key}}) with their values.</p>
<dl class="section return"><dt>Returns</dt><dd>QHttpServerResponder::StatusCode::BadRequest on error or the templated file on success. Both the error and success messages are designed to be exposed to the Emacs UI and are translatable. </dd></dl>

</div>
</div>
<a id="aaec7b23b312a475a45c2832c44e437d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaec7b23b312a475a45c2832c44e437d2">&#9670;&nbsp;</a></span>removeComponent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QHttpServerResponse EmacsServer::removeComponent </td>
          <td>(</td>
          <td class="paramtype">const QJsonObject &amp;&#160;</td>
          <td class="paramname"><em>jsonObject</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Verify the data, and remove a QML component from the application if the provided data is valid. Note that overwriting an existing component typically requires a restart of the applications due to shortcomings in the QML garbage collector.</p>
<dl class="section return"><dt>Returns</dt><dd>QHttpServerResponder::StatusCode::BadRequest on error. Both the error and success messages are designed to be exposed to the Emacs UI and are translatable. </dd></dl>

</div>
</div>
<a id="a50e722ccfd406721163115ac76a81ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50e722ccfd406721163115ac76a81ca4">&#9670;&nbsp;</a></span>restartServer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EmacsServer::restartServer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Restart the web server after configuration has changed. This just destroys the internal HTTP server object, and then calls <a class="el" href="classEmacsServer.html#aad292c65d5dba28d68f3859e8957a71a">startServer()</a> </p>

</div>
</div>
<a id="a9fc08811ca1c3827ff560cd353b97f2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fc08811ca1c3827ff560cd353b97f2a">&#9670;&nbsp;</a></span>setData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QHttpServerResponse EmacsServer::setData </td>
          <td>(</td>
          <td class="paramtype">const QJsonObject &amp;&#160;</td>
          <td class="paramname"><em>jsonObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QString &amp;&#160;</td>
          <td class="paramname"><em>jsonString</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Verify if incoming data as a response to a request triggered through elisp contains a requester ID, and then throw the JSON data up to the UI. No checks if the data itself is useful for the application is possible here.</p>
<dl class="section return"><dt>Returns</dt><dd>QHttpServerResponder::StatusCode::BadRequest on error. Both the error and success messages are designed to be exposed to the Emacs UI and are translatable. </dd></dl>

</div>
</div>
<a id="a16d5d4f4f10c9b8bc9f6276ad6b15d75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16d5d4f4f10c9b8bc9f6276ad6b15d75">&#9670;&nbsp;</a></span>settingCall()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QHttpServerResponse EmacsServer::settingCall </td>
          <td>(</td>
          <td class="paramtype">const QString &amp;&#160;</td>
          <td class="paramname"><em>setting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QByteArray &amp;&#160;</td>
          <td class="paramname"><em>payload</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method for handling /settings mapping of <a class="el" href="classEmacsServer.html#a496f57b0b4ad930622b7770215335c74">startHttpServer()</a>.</p>
<p>Currently the only settings supported are <em>server-key</em> and <em>server-socket</em>. Those two settings are provided wit the key in the header, and the complete POST containing the data, without any padding.</p>
<p>Code for parsing additional key/value pairs fom the POST body is present, but not yet hooked up to the settings backend.</p>
<dl class="section return"><dt>Returns</dt><dd>QHttpServerResponder::StatusCode::BadRequest on error. Both the error and success messages are designed to be exposed to the Emacs UI and are translatable. </dd></dl>

</div>
</div>
<a id="a496f57b0b4ad930622b7770215335c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a496f57b0b4ad930622b7770215335c74">&#9670;&nbsp;</a></span>startHttpServer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EmacsServer::startHttpServer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Start up the actual HTTP server. This creates a new QHttpServer in m_server, and sets up all the mappings. If possible this also does auth token checking - though not for all endpoints it's clear if an auth token is required before evaluating the messag content.</p>
<p>For simple endpoints the implementation is in here as well, though some of that should get split out for simplicity. </p>

</div>
</div>
<a id="aad292c65d5dba28d68f3859e8957a71a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad292c65d5dba28d68f3859e8957a71a">&#9670;&nbsp;</a></span>startServer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EmacsServer::startServer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Setup everything required for the server to work properly, and start it. This is a separate function to allow easy server restarts and to make sure it runs in a separate thread. </p>

</div>
</div>
<a id="ada18dbe6e2d80ea9ca508fb7c0c36b6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada18dbe6e2d80ea9ca508fb7c0c36b6f">&#9670;&nbsp;</a></span>validAuthToken()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool EmacsServer::validAuthToken </td>
          <td>(</td>
          <td class="paramtype">const QString &amp;&#160;</td>
          <td class="paramname"><em>token</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if the provided string is a valid auth token.</p>
<dl class="section return"><dt>Returns</dt><dd>true if valid, false if invalid </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/emacsbridge/emacsbridge/emacsbridge/<a class="el" href="emacsserver_8h_source.html">emacsserver.h</a></li>
<li>/home/runner/work/emacsbridge/emacsbridge/emacsbridge/<a class="el" href="emacsserver_8cpp.html">emacsserver.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
